"use strict";function debug(){return $("#content").toggleClass("show_grid"),$("#content").hasClass("show_grid")}function registerNewsletter(){var register;register=$("#newsletter").attr("checked")?!0:!1,$.ajax({url:"newsletter",data:{newsletter:register}})}var htmlClass="js";void 0!==window.Touch&&(htmlClass+=" touch"),"Microsoft Internet Explorer"==navigator.appName&&(htmlClass+=" ie",document.addEventListener||(htmlClass+=" ie_lt9",document.write('<script src="html5shiv.js"></script>'),document.write('<script id="ie8s" src="selectivizr.js"></script>'))),document.documentElement.className=htmlClass;var globals={sportifSocialTweets:[],autocompleteURL:"/search/autocomplete",autoplayInterval:6e3,ieLt9:"Microsoft Internet Explorer"==navigator.appName&&!document.addEventListener,contextPath:"",languageISO:"en"},Sportif={Common:{cookie:function(){function isCookieEnabled(){var cookieEnabled=!1;return document.cookie="testcookie=1; path=/",cookieEnabled=-1!=document.cookie.indexOf("testcookie")?!0:!1}var cookieBar=$("#cookie-bar"),policyMessage=cookieBar.find("p.policy"),warningMessage=cookieBar.find("p.warning");isCookieEnabled()?(warningMessage.hide(),cookieBar.length>0&&("false"==$.cookie("policy")||void 0==$.cookie("policy"))&&($.cookie("policy","false"),policyMessage.show(),cookieBar.find(".cb-enable").click(function(event){event.preventDefault(),$.cookie("policy","true",{expires:365}),policyMessage.hide()}))):(policyMessage.hide(),warningMessage.show())},urlParamsDetect:function(){if(!Sportif.Common.urlParams){Sportif.Common.urlParams={};for(var match,pl=/\+/g,search=/([^&=]+)=?([^&]*)/g,decode=function(s){return decodeURIComponent(s.replace(pl," "))},query=window.location.search.substring(1);match=search.exec(query);)Sportif.Common.urlParams[decode(match[1])]=decode(match[2])}},videoContent:function(elements){var videoPlayer,videoInner,top;$(elements).each(function(){var item=$(this),links=item.find("a.launch_video"),videoURL=links.attr("href"),videoHeight=links.attr("data-videoheight");videoHeight||(videoHeight=558),links.click(function(e){e.preventDefault();var title=item.find("div.header h3").text();globals.googleAnalytics.trackEvent("Video","Play",title,null,!0),videoURL&&(videoPlayer?(videoPlayer.siblings(".video_active").css({height:"auto"}).removeClass("video_active"),videoPlayer.insertAfter(item),videoInner.attr("src",videoURL)):(videoPlayer=$('<div class="video_player"></div>').insertAfter(item),videoInner=$('<iframe src="'+videoURL+'" width="940" height="'+videoHeight+'" />').appendTo(videoPlayer),$('<a class="button">Close Video</a>').appendTo(videoPlayer).click(function(e){e.preventDefault(),videoInner.attr("src",""),videoPlayer.hide().siblings(".video_active").css({height:"auto"}).removeClass("video_active")})),videoPlayer.show().css({top:item.position().top}),item.css({height:parseInt(videoHeight)+50+"px"}).addClass("video_active"),top=item.offset().top,item.siblings(".editorial").each(function(){var sibling=$(this);sibling.offset().top==top&&sibling.css({height:item.height()+"px"}).addClass("video_active")}))})})},navigationPrimary:function(){var links=$("#primary li, body:not(.cart) #minicart, #cart #continue_shopping");links.bind("click",function(e){Sportif.Nav.panelsAnimation(e,this,links)})},quote:function(){$(".quote > p").contents().unwrap()},languageSelector:function(){var action={check:function(){$(window).height()<$("#languageSelector").height()&&$("#languageSelector").css("height",$(window).height()-parseInt($("#languageSelector").css("border-top")))},show:function(){this.check(),$("#languageSelector").show()},hide:function(){$("#languageSelector").hide()}};$("#website_country").bind("click",function(event){event.stopPropagation(),action.show(),$("header, #content, #closeChangeLanguage").not("#languageSelector").one("click",function(){action.hide()})})},heightMatch:function(elements){var e=$(elements),maxHeight=0;e.each(function(){maxHeight=Math.max($(this).height(),maxHeight)}),e.css("min-height",maxHeight+"px")},widthMatch:function(elements){var e=$(elements),first=e.first(),maxWidth=Math.max(first.find("a").eq(0).width(),first.find("a").eq(1).width());e.find("a").css("width",maxWidth)},refreshScreenReaderBuffer:function(){$("#screen_reader_refresh").attr("value",(new Date).getTime())},searchAutocomplete:function(){function sendAnalytics(action,label,href){globals.googleAnalytics.trackEvent("Internal Site Search",action,label,null,null,href)}function format(data){var container=$(".ui-menu");_.each(data,function(element,index){container.find(".ui-menu-item").eq(index).find("a").attr("href",globals.contextPath+element.url).append(template(element))}),container.append(moreButton),$("li",container).each(function(index){$(this).delay(30*index).hide().fadeIn(100)})}function template(item){var temp='<img src="'+item.imageUrl+'" width="105" height="60"/><h4>'+item.name+"</h4><p>"+item.shortDescription+"</p>";return temp}var search=$("#search"),searchForm=$("form",search),searchInput=$("#search_query",search),socialLinks=$("#social_links, #tiger_link"),searchBoxOrigWidth=searchInput.width(),searchBoxTargetWidth=282,moreButton=$("#autocomplete_more_button",search);searchForm.submit(function(e){e.preventDefault();var term=$.trim(searchInput.val().replace(/\//g," "));return window.location.href=searchForm.attr("action")+(term.length?"/"+encodeURIComponent(term).replace(/\%20/g,"+"):""),term.length>0}),searchInput.on("focus",function(){socialLinks.fadeOut("fast").not("#tiger_link").css({position:"absolute",right:240}),$(this).animate({width:searchBoxTargetWidth+"px",borderTopLeftRadius:0,borderBottomLeftRadius:0}),sendAnalytics("Search Initiated")}).on("blur",function(){$(this).animate({width:searchBoxOrigWidth+"px",borderTopLeftRadius:13,borderBottomLeftRadius:13},function(){socialLinks.removeAttr("style").fadeIn("fast")})}).autocomplete({messages:{noResults:"",results:function(){}},source:function(request,response){$.getJSON(globals.autocompleteURL,{term:searchInput.val()},function(data){response(data),format(data)})},minLength:3,open:function(){$(".ui-menu").css({"z-index":1e4,position:"absolute",top:searchInput.offset().top+searchInput.outerHeight()})},close:function(){$(".ui-menu").css({"z-index":-1})},select:function(event,ui){window.location.href=globals.contextPath+ui.item.url},autoFocus:!1}),$("#ui-id-1").on("click","li a",function(e){e.preventDefault();var href=$(this).attr("href");"more_button"==$(this).attr("id")&&(href=void 0,$("form[name=search_form]").submit()),sendAnalytics("Search Completed",searchInput.val(),href)})},login:function(){$("#loginForm").each(function(){function isValidEmailAddress(email){var emailRegex=/^\S+@\S+\.\S+$/;return emailRegex.test(email)}var form=$(this),email=form.find("#j_username"),error=(form.find("#j_password"),form.find(".validate.field_error"));form.find("input[type=submit]").on("click",function(event){event.preventDefault(),form.find("p.field_error").hide(),isValidEmailAddress(email.val())?form.submit():(email.closest("li").addClass("field_error"),error.show())});var date=new Date;date.setTime(date.getTime()+5e3),$.cookie("login","attempted",{expires:date,path:"/"})})},loginAnalytics:function(){"attempted"==$.cookie("login")&&($.removeCookie("login",{path:"/"}),globals.googleAnalytics.trackEvent("Login","Submit","Returning SPORTIF Customers",4,!0))},searchResultsTabs:function(){$(".search .tab").click(function(e){var $this=$(this);globals.googleAnalytics.trackEvent("Tab Interaction",$this.data("ga-action"),null,null,null,$this.attr("href")),e.preventDefault()})},newsletterSignup:function(){var form=$(".newsletter_signup_form"),messageHtml="<p class='message'></p>",messageElement="";form.on("submit",function(event){function getMessage(){var $element="";return $element="newsletter_signup"!=form.parent().attr("id")?form.find(".message.error").remove().end().find("input[type=submit]").before(messageHtml):form.find(".message.error").remove().end().find("input[type=submit]").parent().after(messageHtml),0==form.find("p").length,form.find("p")}var email=$(this).find("input").val();event.preventDefault(),form=$(this),$.ajax({dataType:"json",url:form.attr("action"),data:{email:email},success:function(data){messageElement=getMessage(),"success"==data.type?(form.find("input, .button").hide(),messageElement.addClass("success").html("<span class='icon'></span>"+data.text),globals.googleAnalytics.trackEvent("Email-Signup","Newsletter",null,null,!0),globals.mixpanel.track("Newsletter subscribed",{email:email})):messageElement.addClass("error").html("<span class='icon'>!</span>"+data.text)},error:function(){messageElement=getMessage(),messageElement.addClass("error").html("<span class='icon'>!</span>Error")}})})},trackOutboundLinks:function(){function stripPortNumber(host){return host.split(":")[0]}$("a").on("click",function(e){var $this=$(this),href=$this.attr("href"),target=$this.attr("target");if(stripPortNumber(e.currentTarget.host)!==stripPortNumber(window.location.host)){if($this.hasClass("launch_video")||"_blank"===target||"_new"===target){var url=href;href=void 0}else e.preventDefault();globals.googleAnalytics.trackEvent("External",url,null,1,!0,href)}})},eventsPageAnalytics:function(){$("body.event").length&&globals.mixpanel.register({"Search-Race name":$("#event_details > .item:first-child h2").text()})},athletesPageAnalytics:function(){function sendAnalytics(title){globals.mixpanel.register({"Search-Athlete name":title})}$("body.athlete").length?sendAnalytics($("#athlete_details > .item:first-child h1 span").text()):$("body.team").length&&sendAnalytics($("#team_details > .item:first-child h2").text())},countrySelector:function(){var countrySelect=$("#country_select");countrySelect.find("#website_country").on("click",function(){var list=$(this).siblings("ol").show();list.on("mouseleave",function(){$(this).hide()})}),countrySelect.find("#languageSelector a").on("click",function(e){e.preventDefault();var href=$(this).attr("href");globals.googleAnalytics.trackEvent("Change Country","Select",$(this).text(),null,!0,href)})}},Nav:{splitArray:[],updateCartHeight:function(){$("#panels > div:visible").length>0&&setTimeout(function(){$("#panels").stop().animate({height:$("#cart_panel").outerHeight()},500)},50)},panelsAnimation:function(e,that,links){var panels=$("div#panels"),panel=0,speed=250,fadeSpeed=speed,animationSpeed=2*speed,li=$(that),a=li.find("a"),panel=li.parent().children(".active").index(li)+1,$element=$("#panels > div:nth-child("+panel+")");panels.queue().length<1&&("minicart"==e.currentTarget.id?($element=$("#cart_panel"),$("#lead").toggleClass("cart_panel_open").find("#minicart").toggleClass("quick")):$(a).is("#cartCouponLink")?$("#lead").addClass("cart_panel_open"):"continue_shopping"==e.currentTarget.id?(e.preventDefault(),$("#minicart").click()):$("#lead").removeClass("cart_panel_open").find("#minicart").removeClass("quick"),a.hasClass("panel_link")?(e.preventDefault(),a.toggleClass("panel_active active"),a.hasClass("panel_active")?(links.find("a.panel_active").length>1?($element.hasClass("split")||$element.css({position:"absolute",visibility:"hidden",display:"block"}),$("#panels > div:visible").fadeOut(fadeSpeed,function(){$element.removeAttr("style").fadeIn(fadeSpeed)})):$element.fadeIn(fadeSpeed),$element.hasClass("split")||(this.splitColumn($element),$element.addClass("split"),this.setMinSize($element)),links.find("a").not(a).removeClass("panel_active active"),panels.animate({height:$element.outerHeight()},animationSpeed)):panels.animate({height:0},animationSpeed).find("> div").fadeOut(fadeSpeed)):$(a).is("#cartCouponLink")&&e.preventDefault())},splitColumn:function(component){var dataJsSplit=$(component).find(".listing ul").attr("data-js-split"),wrapper='<ul class="level_3"></ul>';void 0!==dataJsSplit&&(this.splitArray=dataJsSplit.split(","));var $navigationGroup=$(component).find(".navigation_group"),$listingsContainer=$navigationGroup.find(".listing"),numberOfContainers=$listingsContainer.length;if(this.splitArray.length===numberOfContainers)for(var i=0;numberOfContainers>i;i++)if(0!==parseInt(this.splitArray[i]))for(var $list=$listingsContainer.eq(i).find("ul li"),size=$list.length,j=0;size>j;j++)j%this.splitArray[i]===0&&(0===j&&$list.unwrap(),$listingsContainer.eq(i).find("li").slice(j,j+parseInt(this.splitArray[i])).wrapAll(wrapper));this.splitArray=[]},setMinSize:function(component){for(var $element=$(component).find(".navigation_group").find(".listing"),minHeight=0,minWidth=0,i=0;i<$element.length;i++)minHeight<=$element.eq(i).outerHeight()&&(minHeight=$element.eq(i).outerHeight()),minWidth=parseInt($element.eq(i).css("min-width"))<140?140:parseInt($element.eq(i).css("min-width")),$element.eq(i).css({"min-width":minWidth*($element.eq(i).children().length-1)});$element.css({"min-height":minHeight}),this.setMargin(component)},setMargin:function(component){var $element=$(component).find(".navigation_group:visible").find(".listing"),length=0==$element.find(".featured").length?$element.find("ul.level_3").length:$element.find("ul.level_3").length-1;if($element.length%length!==0)for(var number=0,j=0;j<$element.length+1;j++)if(number<=$(".navigation_group:visible").width())for(var i=0;i<$element.eq(j).find("ul.level_3").length;i++)number+=$(".listing").find("ul li").width()+20;else $element.eq(j-1).css({"margin-right":0,"border-right":"none"})}},Form:{init:function(){Sportif.Form.dropdowns.enableAll(),Sportif.Form.focusField(),Sportif.Form.submitLink(),Sportif.Form.updateSecurityIcon()},dropdowns:{enableDropdown:function(select){function updateDropdown(select,init){var label=select.find("option:selected").text();if(!init){var model=select.attr("data-model");model&&model.length&&(select=$('select[data-model="'+model+'"]'))}select.siblings(".select_ui").find("span.label").text(label)}select.css("opacity",0),updateDropdown(select,!0),select.on("change",function(){updateDropdown(select)})},enableAll:function(){$("select").not(".facet, [data-select]").each(function(){Sportif.Form.dropdowns.enableDropdown($(this))})}},focusField:function(){$("input.text, input:checkbox, input:radio, select").focus(function(){$(this).addClass("focus").closest("li").addClass("focus")}).blur(function(){$(this).removeClass("focus").closest("li").removeClass("focus")})},submitLink:function(){$("a.submit_link","form").click(function(e){e.preventDefault(),$(this).closest("form").submit()})},updateSecurityIcon:function(){var amex=".amex";$("select[name=cardTypeCode]").on("change",function(){var item=$(this).find("option:selected");"amex"==item.val()?($("dl.card_cvv"+amex).css({display:"inline-block"}),$("dl.card_cvv").not(amex).hide()):($("dl.card_cvv"+amex).hide(),$("dl.card_cvv").not(amex).css({display:"inline-block"}))})}},ProductDetail:{init:function(){Sportif.ProductDetail.zoom()},zoom:function(){var zoomLink=$("#zoom_link");if(zoomLink.length){var zoomViewer,zoomLinkSpans=zoomLink.children("span"),primaryImages=$("#product_image_list > li.primary");zoomLink.on("click",function(e){e.preventDefault(),1==primaryImages.length&&(zoomViewer=$('<li class="primary zoom"><img src="'+zoomLink.attr("href")+'" alt=""></li>').insertBefore("li.primary").css({height:primaryImages.height()}),zoomViewer.children("img").load(function(){zoomViewer.viewport().viewport("content").draggable({containment:"parent"})}),primaryImages=primaryImages.add(zoomViewer)),primaryImages.add(zoomLinkSpans).toggleClass("active")})}}},Checkout:{init:function(){Sportif.Checkout.deliveryMethods(),Sportif.Checkout.ajpPaymentMethods(),Sportif.Checkout.billingAddress(),Sportif.Checkout.aopPaymentDetails()},deliveryMethods:function(){$('input[name="delivery_method"]',"#selectDeliveryMethodForm").change(function(){$(this).closest("li").addClass("selected").siblings().removeClass("selected")})},ajpPaymentMethods:function(){$('input[name="paymentType"]',"#selectPaymentMethodForm").change(function(){$(this).closest("li").addClass("selected").siblings().removeClass("selected")})},billingAddress:function(){$("#checkout_billing_details_add").each(function(){function refreshAddressForm(){if(toggle.attr("checked")){area.addClass("disabled").find(":input").attr("disabled","disabled").each(function(){var input=$(this);input.val(input.attr("data-value"))});var state=area.filter(".select.address-state");state.find("span.label").text(state.find("select option:selected").text()),extraRefreshAddressForm()}else{area.removeClass("disabled").find(":input").removeAttr("disabled").each(function(){var input=$(this);input.val("")}),document.getElementById("address.state").options[0].selected=!0;var state=area.filter(".select");state.each(function(){var $this=$(this);$this.find("span.label").text($this.find("select option:selected").text())})}}var form=$(this),toggle=form.find("#useShippingAddress"),area=form.find(".billing_address_field"),afterRefreshAddressForm=function(){},extraRefreshAddressForm=function(){};if("undefined"!=typeof Sportif.AOP&&"function"==typeof Sportif.AOP.storeDeliveryAddress?Sportif.AOP.storeDeliveryAddress():area.find(":input").each(function(){var input=$(this);input.attr("data-value",input.val())}),"undefined"!=typeof Sportif.AAC){var country=form.find(".select.address-country"),state=area.filter(".select.address-state");afterRefreshAddressForm=function(){var currentCountrySelection=area.filter(".select.address-country").find("select option:selected").text();if("United States"!==currentCountrySelection){state.addClass("disabled").find(":input").attr("disabled","disabled").each(function(){var input=$(this);input.val(null)});var stateSelect=area.filter(".select.address-state");stateSelect.find("span.label").text("")}else{state.removeClass("disabled").find(":input").removeAttr("disabled");var stateSelect=area.filter(".select.address-state");stateSelect.find("span.label").text(stateSelect.find("select option:selected").text())}},country.change(function(){afterRefreshAddressForm()}),extraRefreshAddressForm=function(){var countrySelect=area.filter(".select.address-country");countrySelect.find("span.label").text(countrySelect.find("select option:selected").text())}}toggle.change(function(){refreshAddressForm()}),refreshAddressForm()})},aopPaymentDetails:function(){var form=$("#checkout_billing_details_add form");form.submit(function(){return form.find("input:disabled, select:disabled").each(function(){var field=$(this);$("<input />").attr("type","hidden").attr("name",field.attr("name")).attr("value",field.val()).appendTo(form)}),!0})}},StoreFinder:{init:function(){var storeFinderForm=$("#storeFinderForm");storeFinderForm.find("input.text").on("focus",function(){storeFinderForm.find("select").val("").change()})}},IsotopeFiltering:{init:function(){var container=$("body.athletes #athletes"),isotopeContainer=container.find(".isotope-container"),viewContainer=container.find(".item.view"),resultsCount=viewContainer.find("h5 span.count"),singularTitle=viewContainer.find("h5 span.singular"),pluralTitle=viewContainer.find("h5 span.plural"),sortRadioButtons=viewContainer.find("form.sort_name input:radio");isotopeContainer.isotope({layoutMode:"fitRows",itemSelector:".isotope-item",getSortData:{firstName:function($element){return $element.attr("data-firstName")},lastName:function($element){return $element.attr("data-lastName")}}}),$("body.athletes input:radio").on("click",function(){var options,item=$(this),id=item.attr("id"),allItemsId="allSports";options="sort"==item.attr("name")?{sortBy:id}:id==allItemsId?{filter:""}:{filter:"."+id},isotopeContainer.isotope(options,function(items){var len=items.length;1==len?(sortRadioButtons.attr("disabled",!0),singularTitle.show(),pluralTitle.hide()):(sortRadioButtons.attr("disabled",!1),singularTitle.hide(),pluralTitle.show()),resultsCount.text(items.length)})})}},Filtering:{init:function(){function showEvents(type){allEvents.hide();var events=type==allItemsId?allEvents:allEvents.filter("."+type),past=events.filter(".past_event").slice(0,pastEventsMax).show(),pastLength=past.length,upcoming=events.filter(".upcoming_event"),upcomingLength=upcoming.length;upcoming.slice(0,eventsCount).show();var len=upcomingLength+pastLength;resultsCount.text(len),1==len?(singularTitle.show(),pluralTitle.hide()):(singularTitle.hide(),pluralTitle.show()),upcomingLength>0?upcomingTitle.show():upcomingTitle.hide(),past.length>0?pastTitle.show():pastTitle.hide(),showMore.css(eventsCount>=upcomingLength?{visibility:"hidden"}:{visibility:"visible"})}var container=$("body.events #sport_events"),resultsContainer=container.find(".item.view h5"),resultsCount=resultsContainer.find("span.count"),singularTitle=resultsContainer.find("span.singular"),pluralTitle=resultsContainer.find("span.plural"),allEvents=container.find(".event"),upcomingTitle=container.find(".events h2"),pastTitle=container.find(".past_events h2"),showMore=container.find("#showMoreEvents"),allItemsId="allSports",upcomingEventsPagination=12,pastEventsMax=6,filterType=allItemsId,eventsCount=upcomingEventsPagination;showEvents(filterType),container.find("input:radio").each(function(){$(this).on("click",function(event){showEvents(event.currentTarget.id)})}),showMore.on("click",function(event){event.preventDefault(),eventsCount+=upcomingEventsPagination,showEvents(filterType)})}}};_.mixin({deep:function(obj,key,value){var root,keys=key.replace(/\[(["']?)([^\1]+?)\1?\]/g,".$2").replace(/^\./,"").split("."),i=0,n=keys.length;if(arguments.length>2){for(root=obj,n--;n>i;)key=keys[i++],obj=obj[key]=_.isObject(obj[key])?obj[key]:{};obj[keys[i]]=value,value=root}else{for(;null!=(obj=obj[keys[i++]])&&n>i;);value=n>i?void 0:obj}return value}}),_.mixin({pluckDeep:function(obj,key){return _.map(obj,function(value){return _.deep(value,key)})}});